@{
    @*
    Given a root item to display lists out each page and its children
    *@
    var current = Model;
}
    
@while (current != null) {
    var documentPath = current.Get<object[]>("TreePath", new object[] {});
    var children = current.Get<IEnumerable<IDocument>>("Children");
    var hasChildren = children.Count() > 0;

    @if (hasChildren) {
        <li>@documentPath.Last()
        <ul>
        @Html.Partial("partials/_tableOfContents", children.First()) 
        </ul>
        </li>
    }
    else 
    {
        <li>
            <a href="@current.String("site.base-url")/@current.String(Keys.RelativeFilePath)">@current.String("Title")</a>
        </li>
    }
    current = current.Get<IDocument>("NextSibling");
}